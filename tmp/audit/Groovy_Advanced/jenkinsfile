{"status"=>"ok", "data"=>{"result"=>"success", "json"=>{"pipeline"=>{"stages"=>[{"agent"=>{"type"=>"label", "argument"=>{"isLiteral"=>true, "value"=>"docker-agent"}}, "name"=>"Prepare", "branches"=>[{"name"=>"default", "steps"=>[{"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>false, "value"=>"\"Running prepare on ${env.NODE_NAME}\""}}]}, {"name"=>"sh", "arguments"=>[{"key"=>"script", "value"=>{"isLiteral"=>false, "value"=>"\"mkdir -p ${buildDir} && echo build-prep > ${buildDir}/prep.txt\""}}]}, {"name"=>"stash", "arguments"=>[{"key"=>"includes", "value"=>{"isLiteral"=>false, "value"=>"\"${buildDir}/**\""}}, {"key"=>"name", "value"=>{"isLiteral"=>true, "value"=>"prepared"}}]}]}]}, {"name"=>"Parallel Work", "parallel"=>[{"agent"=>{"type"=>"label", "argument"=>{"isLiteral"=>true, "value"=>"docker-agent"}}, "name"=>"Parallel Work-Worker A", "branches"=>[{"name"=>"default", "steps"=>[{"name"=>"unstash", "arguments"=>[{"key"=>"name", "value"=>{"isLiteral"=>true, "value"=>"prepared"}}]}, {"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>false, "value"=>"\"Worker A running on ${env.NODE_NAME}\""}}]}, {"name"=>"sh", "arguments"=>[{"key"=>"script", "value"=>{"isLiteral"=>false, "value"=>"\"echo A > ${buildDir}/a.txt\""}}]}]}]}, {"agent"=>{"type"=>"label", "argument"=>{"isLiteral"=>true, "value"=>"docker-agent"}}, "name"=>"Parallel Work-Worker B", "branches"=>[{"name"=>"default", "steps"=>[{"name"=>"unstash", "arguments"=>[{"key"=>"name", "value"=>{"isLiteral"=>true, "value"=>"prepared"}}]}, {"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>false, "value"=>"\"Worker B running on ${env.NODE_NAME}\""}}]}, {"name"=>"sh", "arguments"=>[{"key"=>"script", "value"=>{"isLiteral"=>false, "value"=>"\"echo B > ${buildDir}/b.txt\""}}]}]}]}]}, {"agent"=>{"type"=>"label", "argument"=>{"isLiteral"=>true, "value"=>"docker-agent"}}, "when"=>{"conditions"=>[{"name"=>"expression", "arguments"=>[{"key"=>"scriptBlock", "value"=>{"isLiteral"=>true, "value"=>"return params.RUN_INTEGRATION"}}]}]}, "name"=>"Integration", "branches"=>[{"name"=>"default", "steps"=>[{"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>true, "value"=>"Running integration tests (dummy)"}}]}, {"name"=>"sh", "arguments"=>[{"key"=>"script", "value"=>{"isLiteral"=>false, "value"=>"\"echo integration > ${buildDir}/integration.txt\""}}]}]}]}, {"agent"=>{"type"=>"label", "argument"=>{"isLiteral"=>true, "value"=>"docker-agent"}}, "name"=>"Package", "branches"=>[{"name"=>"default", "steps"=>[{"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>true, "value"=>"Packaging"}}]}, {"name"=>"sh", "arguments"=>[{"key"=>"script", "value"=>{"isLiteral"=>false, "value"=>"\"tar -czf ${buildDir}/artifact-${BUILD_NUMBER}.tgz -C ${buildDir} .\""}}]}, {"name"=>"archiveArtifacts", "arguments"=>[{"key"=>"artifacts", "value"=>{"isLiteral"=>false, "value"=>"\"${buildDir}/**/*\""}}]}]}]}], "post"=>{"conditions"=>[{"condition"=>"always", "branch"=>{"name"=>"default", "steps"=>[{"name"=>"echo", "arguments"=>[{"key"=>"message", "value"=>{"isLiteral"=>true, "value"=>"Cleaning up workspace"}}]}, {"name"=>"script", "arguments"=>[{"key"=>"scriptBlock", "value"=>{"isLiteral"=>true, "value"=>"node('docker-agent') {\n                    cleanWs()\n                }"}}], :if=>"always()"}]}}]}, "agent"=>{"type"=>"none"}, "parameters"=>{"parameters"=>[{"name"=>"string", "arguments"=>[{"key"=>"name", "value"=>{"isLiteral"=>true, "value"=>"BRANCH"}}, {"key"=>"defaultValue", "value"=>{"isLiteral"=>true, "value"=>"main"}}, {"key"=>"description", "value"=>{"isLiteral"=>true, "value"=>"Git branch"}}]}, {"name"=>"booleanParam", "arguments"=>[{"key"=>"name", "value"=>{"isLiteral"=>true, "value"=>"RUN_INTEGRATION"}}, {"key"=>"defaultValue", "value"=>{"isLiteral"=>true, "value"=>false}}]}]}}}}}